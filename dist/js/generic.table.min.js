!function(e){try{e=angular.module("generic.table")}catch(t){e=angular.module("generic.table",[])}e.run(["$templateCache",function(e){e.put("directive/generic-table/generic-table.html",'<div class="generic-table"><table class="table table-condensed table-hover table-sortable" ng-if="gtHasData"><thead><tr ng-class="::gtRowTransition ? \'fade-in animate\':\'\'"><th ng-repeat="field in ::gtFields | orderBy:\'columnOrder\' track by field.objectKey" ng-show=":gtRefresh:gtSettings | getProperty:field.objectKey:\'visible\'" ng-class=":gtRefresh:[field.classNames, (field.objectKey | camelToDash) + \'-column\', \'sort-\'+(gtSettings | getProperty:field.objectKey:\'sort\')]"><span ng-click=":gtRefresh:(gtSettings | getProperty:field.objectKey:\'sort\') === \'enable\' ? sort(field.objectKey):(gtSettings | getProperty:field.objectKey:\'sort\') === \'asc\' ? sort(field.objectKey):(gtSettings | getProperty:field.objectKey:\'sort\') === \'desc\' ? sort(field.objectKey):\'\'">{{::field.name}}</span></th></tr><tr ng-if="gtTotals" ng-class="::gtRowTransition ? \'fade-in animate\':\'\'"><td ng-repeat="field in ::gtFields | orderBy:\'columnOrder\' track by field.objectKey" class="total-column" ng-show=":gtRefresh:gtSettings | getProperty:field.objectKey:\'visible\'" ng-class="::[(gtFields | getProperty:field.objectKey:\'classNames\'), (field.objectKey | camelToDash) + \'-column\']" ng-bind-html="::gtFields | gtRender:gtTotals:field.objectKey"></td></tr></thead><tbody><tr ng-repeat="row in gtDisplayData | limitTo: displayRows" gt-event="" ng-class="::gtRowTransition ? \'fade-in animate\':\'\'"><td ng-repeat="field in ::gtFields | orderBy:\'columnOrder\' track by field.objectKey" ng-show=":gtRefresh:gtSettings | getProperty:field.objectKey:\'visible\'" ng-class="::[(gtFields | getProperty:field.objectKey:\'classNames\'), (field.objectKey | camelToDash) + \'-column\']"><span ng-class="::field.click ? \'gt-click-enabled\':\'\'" ng-bind-html="::gtFields | gtRender:row:field.objectKey" ng-click="::!field.click || field.click(row)"></span></td></tr></tbody><tr ng-if="pagination === false"><td class="gt-no-data" colspan="{{:gtRefresh:(gtSettings | filter:{\'visible\':true}:true).length}}">{{::gtNoDataTxt}}</td></tr></table><div class="gt-pagination text-center" ng-if="gtPagination === true && pagination !== false"><ul class="pagination"><li ng-class="{disabled: currentPage === 0}" ng-show="currentPage !== 0"><button class="btn-link link" ng-click="previousPage()" translate="ALL.GENERAL#PAGINATION_PREVIOUS#BUTTON" ng-disabled="currentPage === 0">« Prev</button></li><li ng-show="currentPage > 3"><button class="btn-link link" ng-click="setPage(0)">1</button><small>…</small></li><li style="display: inline;padding: 0 5px;" ng-repeat="page in pagination" ng-class="page === currentPage ? \'active\':\'\'"><button class="btn-link link" ng-click="setPage(page)">{{page+1}}</button></li><li ng-show="currentPage +1 < pages.length-1 && pages.length > 4"><small ng-show="currentPage + 3 < pages.length">…</small><button class="btn-link link" ng-click="setPage(pages.length-1)">{{pages.length}}</button></li><li ng-class="{disabled: currentPage == pages.length}" ng-show="currentPage+1 !== pages.length"><button class="btn-link link" ng-click="nextPage()" translate="ALL.GENERAL#PAGINATION_NEXT#BUTTON" ng-disabled="currentPage+1 === pages.length">Next »</button></li></ul></div></div>')}])}(),angular.module("generic.table").directive("genericTable",function(){return{restrict:"E",replace:!0,scope:{gtSettings:"=gtSettings",gtFields:"=gtFields",gtTotals:"=gtTotals",gtData:"=gtData",gtRows:"@gtRows",gtRowTransition:"@gtRowTransition",gtPagination:"@gtPagination",gtNoDataTxt:"@"},templateUrl:"directive/generic-table/generic-table.html",link:function(e,t,n,a){},controller:"genericTableController"}}).controller("genericTableController",["$scope","$filter","$timeout","CSV","$document",function(e,t,n,a,i){var r,o,g,l=[];e.gtPagination="undefined"==typeof e.gtPagination?!0:"false"!==e.gtPagination,e.gtRows="undefined"==typeof e.gtRows?20:e.gtRows,e.gtNoDataTxt="undefined"==typeof e.gtNoDataTxt?"No table data to display":e.gtNoDataTxt,t("map")(e.gtSettings,function(n){try{t("filter")(e.gtFields,{objectKey:n.objectKey},!0)[0].columnOrder=n.columnOrder}catch(a){console.log('field definition object for property: "'+n.objectKey+'" not found.',a)}});var s=function(t){e.gtHasData=!1,r=t.slice(0),e.$emit("gt-started-data-processing"),d(t)},c=function(t){e.gtHasData=!1,r=t.slice(0),e.$emit("gt-started-data-processing"),d(t)},d=function(e){var t=e;u(t),t.length=0},u=function(n){var a=t("map")(t("filter")(e.gtSettings,{enabled:!0},!0),"objectKey");o=t("map")(n,function(n){var i={};return t("map")(a,function(a){if("undefined"!=typeof n[a])i[a]=n[a];else{var r=t("map")(t("filter")(e.gtFields,{objectKey:a},!0),"value")[0];r&&angular.isFunction(r)?i[a]=r(n):console.log('property: "'+a+'" does not exists in data object and no value function was declared')}}),i}),f()},f=function(){g=t("gtSort")(o,l),e.$broadcast("$$rebind::gtRefresh"),p()},p=function(){e.pages=t("chunkBy")(g,parseInt(e.gtRows)),e.currentPage=0,e.loading=!0,e.$emit("gt-started-rendering"),e.gtDisplayData=e.pages[e.currentPage],b(e.pages.length,e.currentPage),n(function(){e.$emit("gt-finished-data-processing"),e.gtHasData=!0},200)};e.$on("gt-update-table",function(e,t){c(t)}),e.$on("gt-update-structure",function(t,n){e.gtFields=n.fields,e.gtSettings=n.settings}),e.$on("gt-paginate-table",function(t,n){e.gtRows=parseInt(n),p()}),e.$on("gt-export-csv",function(e,t){y(t)});var b=function(t,n){return e.pagination=[],0===t?void(e.pagination=!1):void(2>t?e.pagination=[0]:3>t?e.pagination=[0,1]:4>t?e.pagination=[0,1,2]:5>t?e.pagination=[0,1,2,3]:4>n?e.pagination=[0,1,2,3,4]:t>n+1?e.pagination=[n-1,n,n+1]:t===n+1?e.pagination=[n-2,n-1,n]:t-4>n&&(e.pagination=[n-1,n,n+1,n+2]))};e.nextPage=function(){try{e.currentPage++,b(e.pages.length,e.currentPage),e.$emit("gt-started-rendering"),e.gtDisplayData=e.pages[e.currentPage]}catch(t){console.log(t)}},e.previousPage=function(){e.currentPage--,b(e.pages.length,e.currentPage),e.$emit("gt-started-rendering"),e.gtDisplayData=e.pages[e.currentPage]},e.setPage=function(t){e.currentPage=t,b(e.pages.length,e.currentPage),e.$emit("gt-started-rendering"),e.gtDisplayData=e.pages[e.currentPage]},e.sort=function(n){if(n)for(var a=0;e.gtSettings.length>a;a++){var i=e.gtSettings[a];if(i.objectKey===n){var r=i.sort;switch(r){case"disable":break;case"enable":e.gtSettings[a].sort="asc";break;case"asc":e.gtSettings[a].sort="desc";break;case"desc":e.gtSettings[a].sort="enable"}}}l=t("map")(t("filter")(e.gtSettings,{sort:"asc desc"},function(e,t){return t.indexOf(e)>-1}),function(e){return("desc"===e.sort?"-":"")+e.objectKey}),f()},e.gtData&&s(e.gtData);var y=function(r){r="undefined"==typeof r?{}:r;var o="undefined"==typeof r.fileName?"export":r.fileName,l=JSON.parse(angular.toJson(g.slice(0))),s={fieldSep:"undefined"==typeof r.fieldSep?";":r.fieldSep,header:t("map")(t("orderBy")(e.gtFields,"columnOrder"),"name"),txtDelim:"undefined"==typeof r.txtDelim?'"':r.txtDelim,columnOrder:t("map")(t("orderBy")(e.gtFields,"columnOrder"),"objectKey"),decimalSep:"undefined"==typeof r.decimalSep?",":r.decimalSep,addByteOrderMarker:"undefined"==typeof r.addBom,charset:"undefined"==typeof r.charset?"utf-8":r.charset};a.stringify(l,s).then(function(e){var t;if(window.navigator.msSaveOrOpenBlob)t=new Blob([e],{type:"text/csv;charset=utf-8;"}),navigator.msSaveBlob(t,"export.csv");else if("Microsoft Internet Explorer"===window.navigator.appName){window.alert("You're using an old version of Internet Explorer and the export might therefore have the wrong format, please update your browser.");var a=angular.element("<iframe></iframe>");a[0].style.display="none";var r=angular.element("body");r.append(a);var g=null;a[0].contentDocument?g=a[0].contentDocument:a[0].contentWindow&&(g=a[0].contentWindow.document),g.open("text/plain","replace"),g.write([e]),g.close(),g.execCommand("SaveAs",!0,o+".csv")}else{t=new Blob([e],{type:"text/csv;charset=utf-8;"});var l=angular.element("<a></a>");l.attr("href",window.URL.createObjectURL(t)),l.attr("download",o+".csv"),i.find("body").append(l),n(function(){l[0].click(),l.remove()},null)}})}}]).directive("gtEvent",function(){return{restrict:"A",link:function(e,t,n,a){e.$last&&e.$emit("gt-finished-rendering")}}}).filter("getProperty",["$filter",function(e){return function(t,n,a){try{var i=e("filter")(t,{objectKey:n},!0)[0][a]}catch(r){console.log('cannot read property: "'+a+'" on missing key: "'+n+'" in settings.',r)}return i}}]).filter("gtRender",["$filter",function(e){return function(t,n,a){var i;if(angular.isArray(t)){var r=e("filter")(t,{objectKey:a},!0)[0].render;i=r&&angular.isFunction(r)?r(n,a):n[a]}else i=n[a];return i}}]).filter("camelToDash",function(){return function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}).filter("gtSort",function(){return function(e,t){function n(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(n,a){var i=n[e]<a[e]?-1:n[e]>a[e]?1:0;return i*t}}function a(e){var t=e;return function(e,a){for(var i=0,r=0,o=t.length;0===r&&o>i;)r=n(t[i])(e,a),i++;return r}}return e.sort(a(t))}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdlbmVyaWMudGFibGUudHBsLmpzIiwiZ2VuZXJpYy10YWJsZS5qcyJdLCJuYW1lcyI6WyJlIiwiYW5ndWxhciIsIm1vZHVsZSIsInQiLCJydW4iLCJwdXQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJzY29wZSIsImd0U2V0dGluZ3MiLCJndEZpZWxkcyIsImd0VG90YWxzIiwiZ3REYXRhIiwiZ3RSb3dzIiwiZ3RSb3dUcmFuc2l0aW9uIiwiZ3RQYWdpbmF0aW9uIiwiZ3ROb0RhdGFUeHQiLCJ0ZW1wbGF0ZVVybCIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJmbiIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkZmlsdGVyIiwiJHRpbWVvdXQiLCJDU1YiLCIkZG9jdW1lbnQiLCJvcmlnaW5hbERhdGEiLCJtYXBwZWREYXRhIiwic29ydGVkRGF0YSIsInNvcnRpbmciLCJzZXR0aW5nIiwib2JqZWN0S2V5IiwiY29sdW1uT3JkZXIiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJpbml0VGFibGUiLCJpbml0RGF0YSIsImd0SGFzRGF0YSIsInNsaWNlIiwiJGVtaXQiLCJhcHBseUZpbHRlciIsImNoYW5nZURhdGEiLCJuZXdEYXRhIiwiZGF0YSIsImZpbHRlcmVkRGF0YSIsIm1hcEtleXMiLCJsZW5ndGgiLCJwcm9wZXJ0aWVzIiwiZW5hYmxlZCIsInJvdyIsIm9iaiIsInByb3BlcnR5IiwidmFsdWVGdW5jdGlvbiIsImlzRnVuY3Rpb24iLCJhcHBseVNvcnQiLCIkYnJvYWRjYXN0IiwiYXBwbHlQYWdpbmF0aW9uIiwicGFnZXMiLCJwYXJzZUludCIsImN1cnJlbnRQYWdlIiwibG9hZGluZyIsImd0RGlzcGxheURhdGEiLCJwYWdpbmF0aW9uIiwiJG9uIiwiZXZlbnQiLCJhcmciLCJmaWVsZHMiLCJzZXR0aW5ncyIsImd0RXhwb3J0IiwidG90YWxQYWdlcyIsIm5leHRQYWdlIiwicHJldmlvdXNQYWdlIiwic2V0UGFnZSIsInBhZ2UiLCJzb3J0IiwiaSIsImV4cGVjdGVkIiwiYWN0dWFsIiwiaW5kZXhPZiIsIm9wdGlvbnMiLCJmaWxlTmFtZSIsIkpTT04iLCJwYXJzZSIsInRvSnNvbiIsImhlYWRlcnMiLCJmaWVsZFNlcCIsImhlYWRlciIsInR4dERlbGltIiwiZGVjaW1hbFNlcCIsImFkZEJ5dGVPcmRlck1hcmtlciIsImFkZEJvbSIsImNoYXJzZXQiLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzdWx0IiwiYmxvYiIsIndpbmRvdyIsIm5hdmlnYXRvciIsIm1zU2F2ZU9yT3BlbkJsb2IiLCJCbG9iIiwidHlwZSIsIm1zU2F2ZUJsb2IiLCJhcHBOYW1lIiwiYWxlcnQiLCJpZnJhbWUiLCJzdHlsZSIsImRpc3BsYXkiLCJhcHBlbmQiLCJkb2MiLCJjb250ZW50RG9jdW1lbnQiLCJjb250ZW50V2luZG93IiwiZG9jdW1lbnQiLCJvcGVuIiwid3JpdGUiLCJjbG9zZSIsImV4ZWNDb21tYW5kIiwiZG93bmxvYWRMaW5rIiwiYXR0ciIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImZpbmQiLCJjbGljayIsInJlbW92ZSIsIiRsYXN0IiwiZmlsdGVyIiwia2V5Iiwib3V0cHV0IiwiaXNBcnJheSIsInJlbmRlck1ldGhvZCIsInJlbmRlciIsInN0cmluZyIsInRvTG93ZXJDYXNlIiwiYXJyYXkiLCJwcm9wZXJ0eUFycmF5IiwiZHluYW1pY1NvcnQiLCJzb3J0T3JkZXIiLCJzdWJzdHIiLCJhIiwiYiIsImR5bmFtaWNTb3J0TXVsdGlwbGUiLCJwcm9wcyIsIm9iajEiLCJvYmoyIiwibnVtYmVyT2ZQcm9wZXJ0aWVzIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxHQUFBLElBQUFBLEVBQUFDLFFBQUFDLE9BQUEsaUJBQUEsTUFBQUMsR0FBQUgsRUFBQUMsUUFBQUMsT0FBQSxvQkFBQUYsRUFBQUksS0FBQSxpQkFBQSxTQUFBSixHQUFBQSxFQUFBSyxJQUFBLDZDQUFBLG1wR0NrQkFKLFFBQUFDLE9BQUEsaUJBQUFJLFVBQUEsZUFBQSxXQUNBLE9BQ0FD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QUFBSCxFQUFBOUYsT0FJQSxJQUFBZ0QsR0FBQWlELEVBQUFwRSxHQUNBbUIsRUFBQXdDLEVBQUFNLEVBQUFqRSxJQUFBa0UsRUFBQUMsR0FDQW5FLEdBRUEsT0FBQW1CLElBR0EsTUFBQXNDLEdBQUExRCxLQUFBaUUsRUFBQU4iLCJmaWxlIjoiZ2VuZXJpYy50YWJsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIhZnVuY3Rpb24oZSl7dHJ5e2U9YW5ndWxhci5tb2R1bGUoXCJnZW5lcmljLnRhYmxlXCIpfWNhdGNoKHQpe2U9YW5ndWxhci5tb2R1bGUoXCJnZW5lcmljLnRhYmxlXCIsW10pfWUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oZSl7ZS5wdXQoXCJkaXJlY3RpdmUvZ2VuZXJpYy10YWJsZS9nZW5lcmljLXRhYmxlLmh0bWxcIiwnPGRpdiBjbGFzcz1cImdlbmVyaWMtdGFibGVcIj48dGFibGUgY2xhc3M9XCJ0YWJsZSB0YWJsZS1jb25kZW5zZWQgdGFibGUtaG92ZXIgdGFibGUtc29ydGFibGVcIiBuZy1pZj1cImd0SGFzRGF0YVwiPjx0aGVhZD48dHIgbmctY2xhc3M9XCI6Omd0Um93VHJhbnNpdGlvbiA/IFxcJ2ZhZGUtaW4gYW5pbWF0ZVxcJzpcXCdcXCdcIj48dGggbmctcmVwZWF0PVwiZmllbGQgaW4gOjpndEZpZWxkcyB8IG9yZGVyQnk6XFwnY29sdW1uT3JkZXJcXCcgdHJhY2sgYnkgZmllbGQub2JqZWN0S2V5XCIgbmctc2hvdz1cIjpndFJlZnJlc2g6Z3RTZXR0aW5ncyB8IGdldFByb3BlcnR5OmZpZWxkLm9iamVjdEtleTpcXCd2aXNpYmxlXFwnXCIgbmctY2xhc3M9XCI6Z3RSZWZyZXNoOltmaWVsZC5jbGFzc05hbWVzLCAoZmllbGQub2JqZWN0S2V5IHwgY2FtZWxUb0Rhc2gpICsgXFwnLWNvbHVtblxcJywgXFwnc29ydC1cXCcrKGd0U2V0dGluZ3MgfCBnZXRQcm9wZXJ0eTpmaWVsZC5vYmplY3RLZXk6XFwnc29ydFxcJyldXCI+PHNwYW4gbmctY2xpY2s9XCI6Z3RSZWZyZXNoOihndFNldHRpbmdzIHwgZ2V0UHJvcGVydHk6ZmllbGQub2JqZWN0S2V5OlxcJ3NvcnRcXCcpID09PSBcXCdlbmFibGVcXCcgPyBzb3J0KGZpZWxkLm9iamVjdEtleSk6KGd0U2V0dGluZ3MgfCBnZXRQcm9wZXJ0eTpmaWVsZC5vYmplY3RLZXk6XFwnc29ydFxcJykgPT09IFxcJ2FzY1xcJyA/IHNvcnQoZmllbGQub2JqZWN0S2V5KTooZ3RTZXR0aW5ncyB8IGdldFByb3BlcnR5OmZpZWxkLm9iamVjdEtleTpcXCdzb3J0XFwnKSA9PT0gXFwnZGVzY1xcJyA/IHNvcnQoZmllbGQub2JqZWN0S2V5KTpcXCdcXCdcIj57ezo6ZmllbGQubmFtZX19PC9zcGFuPjwvdGg+PC90cj48dHIgbmctaWY9XCJndFRvdGFsc1wiIG5nLWNsYXNzPVwiOjpndFJvd1RyYW5zaXRpb24gPyBcXCdmYWRlLWluIGFuaW1hdGVcXCc6XFwnXFwnXCI+PHRkIG5nLXJlcGVhdD1cImZpZWxkIGluIDo6Z3RGaWVsZHMgfCBvcmRlckJ5OlxcJ2NvbHVtbk9yZGVyXFwnIHRyYWNrIGJ5IGZpZWxkLm9iamVjdEtleVwiIGNsYXNzPVwidG90YWwtY29sdW1uXCIgbmctc2hvdz1cIjpndFJlZnJlc2g6Z3RTZXR0aW5ncyB8IGdldFByb3BlcnR5OmZpZWxkLm9iamVjdEtleTpcXCd2aXNpYmxlXFwnXCIgbmctY2xhc3M9XCI6OlsoZ3RGaWVsZHMgfCBnZXRQcm9wZXJ0eTpmaWVsZC5vYmplY3RLZXk6XFwnY2xhc3NOYW1lc1xcJyksIChmaWVsZC5vYmplY3RLZXkgfCBjYW1lbFRvRGFzaCkgKyBcXCctY29sdW1uXFwnXVwiIG5nLWJpbmQtaHRtbD1cIjo6Z3RGaWVsZHMgfCBndFJlbmRlcjpndFRvdGFsczpmaWVsZC5vYmplY3RLZXlcIj48L3RkPjwvdHI+PC90aGVhZD48dGJvZHk+PHRyIG5nLXJlcGVhdD1cInJvdyBpbiBndERpc3BsYXlEYXRhIHwgbGltaXRUbzogZGlzcGxheVJvd3NcIiBndC1ldmVudD1cIlwiIG5nLWNsYXNzPVwiOjpndFJvd1RyYW5zaXRpb24gPyBcXCdmYWRlLWluIGFuaW1hdGVcXCc6XFwnXFwnXCI+PHRkIG5nLXJlcGVhdD1cImZpZWxkIGluIDo6Z3RGaWVsZHMgfCBvcmRlckJ5OlxcJ2NvbHVtbk9yZGVyXFwnIHRyYWNrIGJ5IGZpZWxkLm9iamVjdEtleVwiIG5nLXNob3c9XCI6Z3RSZWZyZXNoOmd0U2V0dGluZ3MgfCBnZXRQcm9wZXJ0eTpmaWVsZC5vYmplY3RLZXk6XFwndmlzaWJsZVxcJ1wiIG5nLWNsYXNzPVwiOjpbKGd0RmllbGRzIHwgZ2V0UHJvcGVydHk6ZmllbGQub2JqZWN0S2V5OlxcJ2NsYXNzTmFtZXNcXCcpLCAoZmllbGQub2JqZWN0S2V5IHwgY2FtZWxUb0Rhc2gpICsgXFwnLWNvbHVtblxcJ11cIj48c3BhbiBuZy1jbGFzcz1cIjo6ZmllbGQuY2xpY2sgPyBcXCdndC1jbGljay1lbmFibGVkXFwnOlxcJ1xcJ1wiIG5nLWJpbmQtaHRtbD1cIjo6Z3RGaWVsZHMgfCBndFJlbmRlcjpyb3c6ZmllbGQub2JqZWN0S2V5XCIgbmctY2xpY2s9XCI6OiFmaWVsZC5jbGljayB8fCBmaWVsZC5jbGljayhyb3cpXCI+PC9zcGFuPjwvdGQ+PC90cj48L3Rib2R5Pjx0ciBuZy1pZj1cInBhZ2luYXRpb24gPT09IGZhbHNlXCI+PHRkIGNsYXNzPVwiZ3Qtbm8tZGF0YVwiIGNvbHNwYW49XCJ7ezpndFJlZnJlc2g6KGd0U2V0dGluZ3MgfCBmaWx0ZXI6e1xcJ3Zpc2libGVcXCc6dHJ1ZX06dHJ1ZSkubGVuZ3RofX1cIj57ezo6Z3ROb0RhdGFUeHR9fTwvdGQ+PC90cj48L3RhYmxlPjxkaXYgY2xhc3M9XCJndC1wYWdpbmF0aW9uIHRleHQtY2VudGVyXCIgbmctaWY9XCJndFBhZ2luYXRpb24gPT09IHRydWUgJiYgcGFnaW5hdGlvbiAhPT0gZmFsc2VcIj48dWwgY2xhc3M9XCJwYWdpbmF0aW9uXCI+PGxpIG5nLWNsYXNzPVwie2Rpc2FibGVkOiBjdXJyZW50UGFnZSA9PT0gMH1cIiBuZy1zaG93PVwiY3VycmVudFBhZ2UgIT09IDBcIj48YnV0dG9uIGNsYXNzPVwiYnRuLWxpbmsgbGlua1wiIG5nLWNsaWNrPVwicHJldmlvdXNQYWdlKClcIiB0cmFuc2xhdGU9XCJBTEwuR0VORVJBTCNQQUdJTkFUSU9OX1BSRVZJT1VTI0JVVFRPTlwiIG5nLWRpc2FibGVkPVwiY3VycmVudFBhZ2UgPT09IDBcIj7CqyBQcmV2PC9idXR0b24+PC9saT48bGkgbmctc2hvdz1cImN1cnJlbnRQYWdlID4gM1wiPjxidXR0b24gY2xhc3M9XCJidG4tbGluayBsaW5rXCIgbmctY2xpY2s9XCJzZXRQYWdlKDApXCI+MTwvYnV0dG9uPjxzbWFsbD7igKY8L3NtYWxsPjwvbGk+PGxpIHN0eWxlPVwiZGlzcGxheTogaW5saW5lO3BhZGRpbmc6IDAgNXB4O1wiIG5nLXJlcGVhdD1cInBhZ2UgaW4gcGFnaW5hdGlvblwiIG5nLWNsYXNzPVwicGFnZSA9PT0gY3VycmVudFBhZ2UgPyBcXCdhY3RpdmVcXCc6XFwnXFwnXCI+PGJ1dHRvbiBjbGFzcz1cImJ0bi1saW5rIGxpbmtcIiBuZy1jbGljaz1cInNldFBhZ2UocGFnZSlcIj57e3BhZ2UrMX19PC9idXR0b24+PC9saT48bGkgbmctc2hvdz1cImN1cnJlbnRQYWdlICsxIDwgcGFnZXMubGVuZ3RoLTEgJiYgcGFnZXMubGVuZ3RoID4gNFwiPjxzbWFsbCBuZy1zaG93PVwiY3VycmVudFBhZ2UgKyAzIDwgcGFnZXMubGVuZ3RoXCI+4oCmPC9zbWFsbD48YnV0dG9uIGNsYXNzPVwiYnRuLWxpbmsgbGlua1wiIG5nLWNsaWNrPVwic2V0UGFnZShwYWdlcy5sZW5ndGgtMSlcIj57e3BhZ2VzLmxlbmd0aH19PC9idXR0b24+PC9saT48bGkgbmctY2xhc3M9XCJ7ZGlzYWJsZWQ6IGN1cnJlbnRQYWdlID09IHBhZ2VzLmxlbmd0aH1cIiBuZy1zaG93PVwiY3VycmVudFBhZ2UrMSAhPT0gcGFnZXMubGVuZ3RoXCI+PGJ1dHRvbiBjbGFzcz1cImJ0bi1saW5rIGxpbmtcIiBuZy1jbGljaz1cIm5leHRQYWdlKClcIiB0cmFuc2xhdGU9XCJBTEwuR0VORVJBTCNQQUdJTkFUSU9OX05FWFQjQlVUVE9OXCIgbmctZGlzYWJsZWQ9XCJjdXJyZW50UGFnZSsxID09PSBwYWdlcy5sZW5ndGhcIj5OZXh0IMK7PC9idXR0b24+PC9saT48L3VsPjwvZGl2PjwvZGl2PicpfV0pfSgpOyIsIi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgZ2VuZXJpYy50YWJsZS5kaXJlY3RpdmU6Z2VuZXJpY1RhYmxlXG4gKiBAcmVxdWlyZXMgLy8gJ3Byb3ZpZGUgYW55IGRlcGVuZGVuY2llcyBleC4gJHNjb3BlLCB5b3UgY2FuIGhhdmUgbXVsdGlwbGUgQHJlcXVpcmVzIGxpbmVzJ1xuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBEZXNjcmlwdGlvbiBvZiBnZW5lcmljVGFibGUgZGlyZWN0aXZlLCBsb3JlbSBpcHN1bSBkb2xhciBzaXQgYW1ldFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nPX0gZGF0YS1hdHRyaWJ1dGUgLy8gJ2F0dHJpYnV0ZXMgdXNlZCBieSBkaXJlY3RpdmUsIHlvdSBjYW4gaGF2ZSBtdWx0aXBsZSBAcGFyYW0gbGluZXMnXG4gKlxuICogIEBleGFtcGxlIDxwcmU+XG4gKlxuICogPGdlbmVyaWMtdGFibGUgZGF0YS1hdHRyaWJ1dGU9XCJteS12YWx1ZVwiPjwvZ2VuZXJpYy10YWJsZT5cbiAqXG4gKiA8L3ByZT5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2dlbmVyaWMudGFibGUnKS5kaXJlY3RpdmUoJ2dlbmVyaWNUYWJsZScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBndFNldHRpbmdzOic9Z3RTZXR0aW5ncycsXG4gICAgICAgICAgICBndEZpZWxkczonPWd0RmllbGRzJyxcbiAgICAgICAgICAgIGd0VG90YWxzOic9Z3RUb3RhbHMnLFxuICAgICAgICAgICAgLy9ndEluZGV4Oic9Z3RJbmRleCcsXG4gICAgICAgICAgICBndERhdGE6Jz1ndERhdGEnLFxuICAgICAgICAgICAgZ3RSb3dzOidAZ3RSb3dzJyxcbiAgICAgICAgICAgIGd0Um93VHJhbnNpdGlvbjonQGd0Um93VHJhbnNpdGlvbicsXG4gICAgICAgICAgICBndFBhZ2luYXRpb246J0BndFBhZ2luYXRpb24nLFxuICAgICAgICAgICAgZ3ROb0RhdGFUeHQ6J0AnXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL2dlbmVyaWMtdGFibGUvZ2VuZXJpYy10YWJsZS5odG1sJyxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBmbikge1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOlwiZ2VuZXJpY1RhYmxlQ29udHJvbGxlclwiXG4gICAgfTtcbn0pLmNvbnRyb2xsZXIoJ2dlbmVyaWNUYWJsZUNvbnRyb2xsZXInLGZ1bmN0aW9uKCRzY29wZSwkZmlsdGVyLCR0aW1lb3V0LCBDU1YsJGRvY3VtZW50KXtcbiAgICB2YXIgb3JpZ2luYWxEYXRhOyAvLyBvcmlnaW5hbCB1bnRvdWNoZWQgZGF0YVxuICAgIHZhciBtYXBwZWREYXRhOyAvLyBtYXBwZWQgZGF0YSwgYXJyYXkgY29udGFpbmluZyBtYXBwZWQga2V5cyB1c2VkIGJ5IHRhYmxlXG4gICAgdmFyIHNvcnRlZERhdGE7IC8vIHNvcnRlZCBtYXBwZWQgZGF0YVxuICAgIHZhciBzb3J0aW5nID0gW107IC8vIGFycmF5IGNvbnRhaW5pbmcgc29ydGluZyBjcml0ZXJpYXNcbiAgICAkc2NvcGUuZ3RQYWdpbmF0aW9uID0gdHlwZW9mICRzY29wZS5ndFBhZ2luYXRpb24gPT09ICd1bmRlZmluZWQnID8gdHJ1ZTokc2NvcGUuZ3RQYWdpbmF0aW9uICE9PSAnZmFsc2UnO1xuICAgICRzY29wZS5ndFJvd3MgPSB0eXBlb2YgJHNjb3BlLmd0Um93cyA9PT0gJ3VuZGVmaW5lZCcgPyAyMDokc2NvcGUuZ3RSb3dzO1xuICAgICRzY29wZS5ndE5vRGF0YVR4dCA9IHR5cGVvZiAkc2NvcGUuZ3ROb0RhdGFUeHQgPT09ICd1bmRlZmluZWQnID8gJ05vIHRhYmxlIGRhdGEgdG8gZGlzcGxheSc6JHNjb3BlLmd0Tm9EYXRhVHh0O1xuICAgIC8qJHNjb3BlLnRhYmxlID0ge1xuICAgICBpbmRleDokc2NvcGUuZ3RJbmRleCxcbiAgICAgc2V0dGluZ3M6ICRzY29wZS5ndFNldHRpbmdzLFxuICAgICB0b3RhbHM6ICRzY29wZS5ndFRvdGFscyxcbiAgICAgZmllbGRzOiRzY29wZS5ndEZpZWxkc1xuICAgICB9OyovXG5cbiAgICAvLyBvcmRlciBjb2x1bW5zXG4gICAgJGZpbHRlcignbWFwJykoJHNjb3BlLmd0U2V0dGluZ3MsZnVuY3Rpb24oc2V0dGluZyl7XG4gICAgICAgIHRyeXskZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuZ3RGaWVsZHMse29iamVjdEtleTpzZXR0aW5nLm9iamVjdEtleX0sdHJ1ZSlbMF0uY29sdW1uT3JkZXIgPSBzZXR0aW5nLmNvbHVtbk9yZGVyO30gY2F0Y2goZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmaWVsZCBkZWZpbml0aW9uIG9iamVjdCBmb3IgcHJvcGVydHk6IFwiJysgc2V0dGluZy5vYmplY3RLZXkgKydcIiBub3QgZm91bmQuJyxlcnJvcik7XG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgdmFyIGluaXRUYWJsZSA9IGZ1bmN0aW9uKGluaXREYXRhKXtcbiAgICAgICAgJHNjb3BlLmd0SGFzRGF0YSA9IGZhbHNlO1xuICAgICAgICBvcmlnaW5hbERhdGEgPSBpbml0RGF0YS5zbGljZSgwKTtcbiAgICAgICAgJHNjb3BlLiRlbWl0KCdndC1zdGFydGVkLWRhdGEtcHJvY2Vzc2luZycpO1xuICAgICAgICBhcHBseUZpbHRlcihpbml0RGF0YSk7XG4gICAgfTtcblxuICAgIC8vIGNoYW5nZSBkYXRhLCB0aGlzIHdlIHVwZGF0ZSBvciBkYXRhIHNldFxuICAgIHZhciBjaGFuZ2VEYXRhID0gZnVuY3Rpb24obmV3RGF0YSl7XG4gICAgICAgICRzY29wZS5ndEhhc0RhdGEgPSBmYWxzZTtcbiAgICAgICAgb3JpZ2luYWxEYXRhID0gbmV3RGF0YS5zbGljZSgwKTtcbiAgICAgICAgJHNjb3BlLiRlbWl0KCdndC1zdGFydGVkLWRhdGEtcHJvY2Vzc2luZycpO1xuICAgICAgICBhcHBseUZpbHRlcihuZXdEYXRhKTtcbiAgICB9O1xuXG4gICAgLy8gaW50ZXJuYWwgZmlsdGVyLCB0aGlzIGlzIHdoZXJlIHdlIGFwcGx5IGZpbHRlcnNcbiAgICB2YXIgYXBwbHlGaWx0ZXIgPSBmdW5jdGlvbiAoZGF0YSl7XG4gICAgICAgIHZhciBmaWx0ZXJlZERhdGEgPSBkYXRhO1xuICAgICAgICBtYXBLZXlzKGZpbHRlcmVkRGF0YSk7XG4gICAgICAgIGZpbHRlcmVkRGF0YS5sZW5ndGggPSAwO1xuICAgIH07XG5cbiAgICAvLyBtYXBwaW5nLCB0aGlzIGlzIHdoZXJlIHdlIG1hcCB3aGljaCBrZXlzIHNob3VsZCBiZSBwYXJ0IG9mIHRoZSB0YWJsZSBhcnJheSByb3cgb2JqZWN0XG4gICAgdmFyIG1hcEtleXMgPSBmdW5jdGlvbiAoZGF0YSl7XG5cbiAgICAgICAgLy8gZ2V0IGtleSBuYW1lcyBmcm9tIHNldHRpbmdzXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gJGZpbHRlcignbWFwJykoJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmd0U2V0dGluZ3MsIHtlbmFibGVkOnRydWV9LHRydWUpLCdvYmplY3RLZXknKTtcblxuICAgICAgICAvLyBjcmVhdGUgbmV3IGFycmF5IHdpdGggbWFwcGVkIGRhdGFcbiAgICAgICAgbWFwcGVkRGF0YSA9ICRmaWx0ZXIoJ21hcCcpKGRhdGEsIGZ1bmN0aW9uKHJvdyl7XG4gICAgICAgICAgICB2YXIgb2JqID0ge307IC8vIGNyZWF0ZSBuZXcgcm93IG9iamVjdFxuXG4gICAgICAgICAgICAvLyByZXRyaWV2ZSBvYmplY3QgdmFsdWVzIGZyb20gcm93IGFuZCBhZGQgdGhlbSB0byB0aGUgY29ycmVzcG9uZGluZyBrZXkgZGVmaW5lZCBieSB0aGUgdGFibGUgZmllbGRzXG4gICAgICAgICAgICAkZmlsdGVyKCdtYXAnKShwcm9wZXJ0aWVzLGZ1bmN0aW9uKHByb3BlcnR5KXtcbiAgICAgICAgICAgICAgICAvLyBpZiBwcm9wZXJ0eSBleGlzdHMgaW4gZGF0YSBvYmplY3QuLi5cbiAgICAgICAgICAgICAgICBpZih0eXBlb2Ygcm93W3Byb3BlcnR5XSAhPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgY29sdW1uIHZhbHVlIGZyb20gZGF0YSBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICBvYmpbcHJvcGVydHldPXJvd1twcm9wZXJ0eV1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdwcm9wZXJ0eTogXCInICsgcHJvcGVydHkgICsgJ1wiIGRvZXMgbm90IGV4aXN0IGluIGRhdGEgb2JqZWN0LCBhdHRlbXB0aW5nIHRvIHVzZSB2YWx1ZSBmdW5jdGlvbiBpbnN0ZWFkICcpO1xuICAgICAgICAgICAgICAgICAgICAvLyBwcm9wZXJ0eSBkb2VzIG5vdCBleGlzdHMgaW4gZGF0YSwgdXNlIHZhbHVlIGZ1bmN0aW9uIHRvIGdldCB2YWx1ZSBmb3IgY29sdW1uXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZUZ1bmN0aW9uID0gJGZpbHRlcignbWFwJykoJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmd0RmllbGRzLCB7b2JqZWN0S2V5OnByb3BlcnR5fSx0cnVlKSwndmFsdWUnKVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYodmFsdWVGdW5jdGlvbiAmJiBhbmd1bGFyLmlzRnVuY3Rpb24odmFsdWVGdW5jdGlvbikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIGN1c3RvbSB2YWx1ZSBmdW5jdGlvbiB0byByZXRyaWV2ZSB2YWx1ZSBmb3IgY29sdW1uXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCd1c2luZyB2YWx1ZSBmdW5jdGlvbiB0byBnZXQgZGF0YSBmb3Igcm93IGNvbHVtbiAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ialtwcm9wZXJ0eV0gPSB2YWx1ZUZ1bmN0aW9uKHJvdyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncHJvcGVydHk6IFwiJyArIHByb3BlcnR5ICArICdcIiBkb2VzIG5vdCBleGlzdHMgaW4gZGF0YSBvYmplY3QgYW5kIG5vIHZhbHVlIGZ1bmN0aW9uIHdhcyBkZWNsYXJlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gYXBwbHkgc29ydCB0byBvdXIgbWFwcGVkIGFycmF5XG4gICAgICAgIGFwcGx5U29ydCgpO1xuICAgIH07XG5cbiAgICAvLyBzb3J0LCB0aGlzIGlzIHdoZXJlIHdlIHNvcnQgdGhlIGZpbHRlcmVkIHJlc3VsdHNcbiAgICB2YXIgYXBwbHlTb3J0ID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIHNvcnRlZERhdGEgPSAkZmlsdGVyKCdndFNvcnQnKShtYXBwZWREYXRhLCBzb3J0aW5nKTtcbiAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJyQkcmViaW5kOjpndFJlZnJlc2gnKTtcbiAgICAgICAgYXBwbHlQYWdpbmF0aW9uKCk7XG4gICAgfTtcblxuICAgIC8vIHBhZ2luYXRpb24sIHRoaXMgaXMgd2hlcmUgd2UgZGVjaWRlIHdoaWNoIHN1YnNldCBvZiB0aGUgZGF0YSB0byBzaG93XG4gICAgdmFyIGFwcGx5UGFnaW5hdGlvbiA9IGZ1bmN0aW9uICgpe1xuICAgICAgICAkc2NvcGUucGFnZXMgPSAkZmlsdGVyKCdjaHVua0J5Jykoc29ydGVkRGF0YSwgcGFyc2VJbnQoJHNjb3BlLmd0Um93cykpO1xuICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgPSAwO1xuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICRzY29wZS4kZW1pdCgnZ3Qtc3RhcnRlZC1yZW5kZXJpbmcnKTtcbiAgICAgICAgJHNjb3BlLmd0RGlzcGxheURhdGEgPSAkc2NvcGUucGFnZXNbJHNjb3BlLmN1cnJlbnRQYWdlXTtcbiAgICAgICAgcGFnaW5hdGlvbigkc2NvcGUucGFnZXMubGVuZ3RoLCRzY29wZS5jdXJyZW50UGFnZSk7XG5cbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICRzY29wZS4kZW1pdCgnZ3QtZmluaXNoZWQtZGF0YS1wcm9jZXNzaW5nJyk7XG4gICAgICAgICAgICAkc2NvcGUuZ3RIYXNEYXRhID0gdHJ1ZTtcbiAgICAgICAgfSwyMDApO1xuICAgICAgICAvLyRzY29wZS4kZW1pdCgnZ3QtZmluaXNoZWQtcmVuZGVyaW5nJyk7XG4gICAgICAgIC8qaWYoJHNjb3BlLmxvYWRpbmcpe1xuICAgICAgICAgY29uc29sZS5sb2coJ3N0aWxsIGxvb2FkaW5nJyk7XG4gICAgICAgICAkc2NvcGUuJGVtaXQoJ2d0LWZpbmlzaGVkLXJlbmRlcmluZycpO1xuICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgIH0qL1xuICAgIH07XG5cbiAgICAvLyBsaXN0ZW4gZm9yIHVwZGF0ZSB0YWJsZSBldmVudHNcbiAgICAkc2NvcGUuJG9uKCdndC11cGRhdGUtdGFibGUnLGZ1bmN0aW9uKGV2ZW50LGFyZyl7XG4gICAgICAgIGNoYW5nZURhdGEoYXJnKTtcbiAgICB9KTtcblxuICAgIC8vIGxpc3RlbiBmb3IgdXBkYXRlIHRhYmxlIGV2ZW50c1xuICAgICRzY29wZS4kb24oJ2d0LXVwZGF0ZS1zdHJ1Y3R1cmUnLGZ1bmN0aW9uKGV2ZW50LGFyZyl7XG4gICAgICAgICRzY29wZS5ndEZpZWxkcyA9IGFyZy5maWVsZHM7XG4gICAgICAgICRzY29wZS5ndFNldHRpbmdzID0gYXJnLnNldHRpbmdzO1xuICAgIH0pO1xuXG5cbiAgICAvLyBsaXN0ZW4gZm9yIHBhZ2luYXRpb24gbGVuZ3RoIGNoYW5nZVxuICAgICRzY29wZS4kb24oJ2d0LXBhZ2luYXRlLXRhYmxlJyxmdW5jdGlvbihldmVudCxhcmcpe1xuICAgICAgICAkc2NvcGUuZ3RSb3dzID0gcGFyc2VJbnQoYXJnKTtcbiAgICAgICAgYXBwbHlQYWdpbmF0aW9uKCk7XG4gICAgfSk7XG5cbiAgICAvLyBsaXN0ZW4gZm9yIGV4cG9ydCBldmVudFxuICAgICRzY29wZS4kb24oJ2d0LWV4cG9ydC1jc3YnLGZ1bmN0aW9uKGV2ZW50LGFyZyl7XG4gICAgICAgIGd0RXhwb3J0KGFyZyk7XG4gICAgfSk7XG5cblxuICAgIC8vIGNyZWF0ZSBwYWdpbmF0aW9uXG4gICAgdmFyIHBhZ2luYXRpb24gPSBmdW5jdGlvbih0b3RhbFBhZ2VzLCBjdXJyZW50UGFnZSl7XG4gICAgICAgICRzY29wZS5wYWdpbmF0aW9uID0gW107XG5cbiAgICAgICAgLy8gaWYgdG90YWwgcGFnZXMgZXF1YWxzIDAgaWUuIG5vIGRhdGEgYXZhaWxhYmxlXG4gICAgICAgIGlmKHRvdGFsUGFnZXMgPT09IDAgKSB7XG4gICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgbGVzcyB0aGFuIHR3byBwYWdlc1xuICAgICAgICBpZih0b3RhbFBhZ2VzIDwgMil7XG4gICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbiA9IFswXTtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBsZXNzIHRoYW4gdGhyZWUgcGFnZXNcbiAgICAgICAgZWxzZSBpZih0b3RhbFBhZ2VzIDwgMyl7XG4gICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbiA9IFswLDFdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIGxlc3MgdGhhbiBmb3VyIHBhZ2VzXG4gICAgICAgIGVsc2UgaWYodG90YWxQYWdlcyA8IDQpe1xuICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb24gPSBbMCwxLDJdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIGxlc3MgdGhhbiBmaXZlIHBhZ2VzXG4gICAgICAgIGVsc2UgaWYodG90YWxQYWdlcyA8IDUpe1xuICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb24gPSBbMCwxLDIsM107XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgY3VycmVudCBwYWdlIGlzIG9uZSBvZiB0aGUgZm91ciBmaXJzdCBwYWdlc1xuICAgICAgICBlbHNlIGlmKGN1cnJlbnRQYWdlIDwgNCl7XG4gICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbiA9IFswLDEsMiwzLDRdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIG5leHQgdG8gbGFzdCBwYWdlXG4gICAgICAgIGVsc2UgaWYodG90YWxQYWdlcyA+IGN1cnJlbnRQYWdlKzEpe1xuICAgICAgICAgICAgJHNjb3BlLnBhZ2luYXRpb24gPSBbY3VycmVudFBhZ2UtMSxjdXJyZW50UGFnZSxjdXJyZW50UGFnZSsxXTtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBsYXN0IHBhZ2VcbiAgICAgICAgZWxzZSBpZih0b3RhbFBhZ2VzID09PSBjdXJyZW50UGFnZSsxKXtcbiAgICAgICAgICAgICRzY29wZS5wYWdpbmF0aW9uID0gW2N1cnJlbnRQYWdlLTIsY3VycmVudFBhZ2UtMSxjdXJyZW50UGFnZV07XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgY3VycmVudCBwYWdlIGlzIG5vdCBvbmUgb2YgdGhlIGZvdXIgZmlyc3QgcGFnZXNcbiAgICAgICAgZWxzZSBpZih0b3RhbFBhZ2VzLTQgPiBjdXJyZW50UGFnZSl7XG4gICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbiA9IFtjdXJyZW50UGFnZS0xLGN1cnJlbnRQYWdlLGN1cnJlbnRQYWdlKzEsIGN1cnJlbnRQYWdlKzJdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICRzY29wZS5uZXh0UGFnZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgKys7XG4gICAgICAgICAgICBwYWdpbmF0aW9uKCRzY29wZS5wYWdlcy5sZW5ndGgsJHNjb3BlLmN1cnJlbnRQYWdlKTtcbiAgICAgICAgICAgICRzY29wZS4kZW1pdCgnZ3Qtc3RhcnRlZC1yZW5kZXJpbmcnKTtcbiAgICAgICAgICAgICRzY29wZS5ndERpc3BsYXlEYXRhID0gJHNjb3BlLnBhZ2VzWyRzY29wZS5jdXJyZW50UGFnZV07XG4gICAgICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgICRzY29wZS5wcmV2aW91c1BhZ2UgPSBmdW5jdGlvbigpe1xuICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgLS07XG4gICAgICAgIHBhZ2luYXRpb24oJHNjb3BlLnBhZ2VzLmxlbmd0aCwkc2NvcGUuY3VycmVudFBhZ2UpO1xuICAgICAgICAkc2NvcGUuJGVtaXQoJ2d0LXN0YXJ0ZWQtcmVuZGVyaW5nJyk7XG4gICAgICAgICRzY29wZS5ndERpc3BsYXlEYXRhID0gJHNjb3BlLnBhZ2VzWyRzY29wZS5jdXJyZW50UGFnZV07XG4gICAgfTtcbiAgICAkc2NvcGUuc2V0UGFnZSA9IGZ1bmN0aW9uKHBhZ2Upe1xuICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgPSBwYWdlO1xuICAgICAgICBwYWdpbmF0aW9uKCRzY29wZS5wYWdlcy5sZW5ndGgsJHNjb3BlLmN1cnJlbnRQYWdlKTtcbiAgICAgICAgJHNjb3BlLiRlbWl0KCdndC1zdGFydGVkLXJlbmRlcmluZycpO1xuICAgICAgICAkc2NvcGUuZ3REaXNwbGF5RGF0YSA9ICRzY29wZS5wYWdlc1skc2NvcGUuY3VycmVudFBhZ2VdO1xuICAgIH07XG5cbiAgICAvLyBzb3J0IGZ1bmN0aW9uXG4gICAgJHNjb3BlLnNvcnQgPSBmdW5jdGlvbihwcm9wZXJ0eSl7XG4gICAgICAgIGlmIChwcm9wZXJ0eSl7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgJHNjb3BlLmd0U2V0dGluZ3MubGVuZ3RoID4gaTsgaSsrKXtcbiAgICAgICAgICAgICAgICB2YXIgc2V0dGluZyA9ICRzY29wZS5ndFNldHRpbmdzW2ldO1xuICAgICAgICAgICAgICAgIGlmKHNldHRpbmcub2JqZWN0S2V5ID09PSBwcm9wZXJ0eSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3J0ID0gc2V0dGluZy5zb3J0O1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHNvcnQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGlzYWJsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ3RTZXR0aW5nc1tpXS5zb3J0ID0gJ2FzYyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhc2MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ndFNldHRpbmdzW2ldLnNvcnQgPSAnZGVzYyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkZXNjJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ3RTZXR0aW5nc1tpXS5zb3J0ID0gJ2VuYWJsZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHNvcnRpbmcgPSAkZmlsdGVyKCdtYXAnKSgkZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuZ3RTZXR0aW5ncyx7c29ydDpcImFzYyBkZXNjXCJ9LGZ1bmN0aW9uKGV4cGVjdGVkLCBhY3R1YWwpe1xuICAgICAgICAgICAgcmV0dXJuIGFjdHVhbC5pbmRleE9mKGV4cGVjdGVkKSA+IC0xO1xuICAgICAgICB9KSxmdW5jdGlvbihzb3J0KXtcbiAgICAgICAgICAgIHJldHVybiAoc29ydC5zb3J0ID09PSAnZGVzYycgPyAnLSc6JycpICsgc29ydC5vYmplY3RLZXlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXBwbHlTb3J0KCk7XG4gICAgfTtcblxuICAgIC8vIGlmIHRhYmxlIGhhcyBkYXRhIHVwb24gaW5pdGlhbGl6YXRpb24uLi5cbiAgICBpZigkc2NvcGUuZ3REYXRhKXtcbiAgICAgICAgaW5pdFRhYmxlKCRzY29wZS5ndERhdGEpOyAvLyBpbml0aWFsaXplIHRhYmxlIHdpdGggZGF0YSBwYXNzZWQgdG8gZGlyZWN0aXZlXG4gICAgfVxuXG4gICAgLy8gZXhwb3J0IGZ1bmN0aW9uXG4gICAgdmFyIGd0RXhwb3J0ID0gZnVuY3Rpb24ob3B0aW9ucyl7XG4gICAgICAgIG9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gJ3VuZGVmaW5lZCc/IHt9Om9wdGlvbnM7XG5cbiAgICAgICAgdmFyIGZpbGVOYW1lID0gdHlwZW9mIG9wdGlvbnMuZmlsZU5hbWUgPT09ICd1bmRlZmluZWQnID8gJ2V4cG9ydCc6b3B0aW9ucy5maWxlTmFtZTtcbiAgICAgICAgLy8gZGVjbGFyZSBleHBvcnQgZGF0YVxuICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoYW5ndWxhci50b0pzb24oc29ydGVkRGF0YS5zbGljZSgwKSkpO1xuICAgICAgICB2YXIgaGVhZGVycyA9IHtcbiAgICAgICAgICAgIGZpZWxkU2VwOiB0eXBlb2Ygb3B0aW9ucy5maWVsZFNlcCA9PT0gJ3VuZGVmaW5lZCcgPyBcIjtcIjpvcHRpb25zLmZpZWxkU2VwLFxuICAgICAgICAgICAgaGVhZGVyOiAkZmlsdGVyKCdtYXAnKSgkZmlsdGVyKCdvcmRlckJ5JykoJHNjb3BlLmd0RmllbGRzLFwiY29sdW1uT3JkZXJcIiksXCJuYW1lXCIpLCAvLyBnZXQgaGVhZGVycyBieSBjb2x1bW4gb3JkZXJcbiAgICAgICAgICAgIHR4dERlbGltOiB0eXBlb2Ygb3B0aW9ucy50eHREZWxpbSA9PT0gJ3VuZGVmaW5lZCcgPyAnXCInOm9wdGlvbnMudHh0RGVsaW0sXG4gICAgICAgICAgICBjb2x1bW5PcmRlcjokZmlsdGVyKCdtYXAnKSgkZmlsdGVyKCdvcmRlckJ5JykoJHNjb3BlLmd0RmllbGRzLFwiY29sdW1uT3JkZXJcIiksXCJvYmplY3RLZXlcIiksIC8vIGdldCBjb2x1bW4gb3JkZXJcbiAgICAgICAgICAgIGRlY2ltYWxTZXA6dHlwZW9mIG9wdGlvbnMuZGVjaW1hbFNlcCA9PT0gJ3VuZGVmaW5lZCcgPyAnLCc6b3B0aW9ucy5kZWNpbWFsU2VwLFxuICAgICAgICAgICAgYWRkQnl0ZU9yZGVyTWFya2VyOnR5cGVvZiBvcHRpb25zLmFkZEJvbSA9PT0gJ3VuZGVmaW5lZCcsXG4gICAgICAgICAgICBjaGFyc2V0OnR5cGVvZiBvcHRpb25zLmNoYXJzZXQgPT09ICd1bmRlZmluZWQnID8gJ3V0Zi04JzpvcHRpb25zLmNoYXJzZXRcbiAgICAgICAgfTtcbiAgICAgICAgQ1NWLnN0cmluZ2lmeShkYXRhLCBoZWFkZXJzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cbiAgICAgICAgICAgIHZhciBibG9iO1xuXG4gICAgICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKSB7XG4gICAgICAgICAgICAgICAgYmxvYiA9IG5ldyBCbG9iKFtyZXN1bHRdLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidGV4dC9jc3Y7Y2hhcnNldD11dGYtODtcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG5hdmlnYXRvci5tc1NhdmVCbG9iKGJsb2IsICdleHBvcnQuY3N2Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIG5vdCBhIGZ1bGx5IHdvcmtpbmcgc29sdXRpb24sIHNvbWUgdGFncyAodGV4IDxCT0RZPikgc2hvdyB1cCBpbiBleGNlbCB0b2dldGhlciB3aXRoIHRoZSBjb3JyZWN0IGRhdGEuXG4gICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhZGRlZCBhbiBhbGVydCBtZXNzYWdlIHRvIHVyZ2UgdXNlcnMgdG8gdXNlIGFub3RoZXIgYnJvd3NlciBvciB1cGRhdGUgdGhlaXIgYnJvd3NlciBmb3IgYSBiZXR0ZXIgbG9va2luZyBleHBvcnQuXG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5uYXZpZ2F0b3IuYXBwTmFtZSA9PT0gJ01pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3JlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KFwiWW91J3JlIHVzaW5nIGFuIG9sZCB2ZXJzaW9uIG9mIEludGVybmV0IEV4cGxvcmVyIGFuZCB0aGUgZXhwb3J0IG1pZ2h0IHRoZXJlZm9yZSBoYXZlIHRoZSB3cm9uZyBmb3JtYXQsIHBsZWFzZSB1cGRhdGUgeW91ciBicm93c2VyLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlmcmFtZSA9IGFuZ3VsYXIuZWxlbWVudCgnPGlmcmFtZT48L2lmcmFtZT4nKTtcbiAgICAgICAgICAgICAgICAgICAgaWZyYW1lWzBdLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoJ2JvZHknKTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQoaWZyYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZnJhbWVbMF0uY29udGVudERvY3VtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSBpZnJhbWVbMF0uY29udGVudERvY3VtZW50O1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZiAoaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cpe1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jID0gaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZG9jLm9wZW4oXCJ0ZXh0L3BsYWluXCIsIFwicmVwbGFjZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jLndyaXRlKFtyZXN1bHRdKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vaWZyYW1lLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGRvYy5leGVjQ29tbWFuZCgnU2F2ZUFzJywgdHJ1ZSwgZmlsZU5hbWUrJy5jc3YnKTtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgYmxvYiA9IG5ldyBCbG9iKFtyZXN1bHRdLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRleHQvY3N2O2NoYXJzZXQ9dXRmLTg7XCJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkb3dubG9hZExpbmsgPSBhbmd1bGFyLmVsZW1lbnQoJzxhPjwvYT4nKTtcbiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaW5rLmF0dHIoJ2hyZWYnLCB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKSk7XG4gICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGluay5hdHRyKCdkb3dubG9hZCcsZmlsZU5hbWUrJy5jc3YnKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBhcHBlbmQgZG93bmxvYWQgbGluayB0byBib2R5IGFuZCBjbGljayBpdCwgb25jZSBjbGlja2VkIHJlbW92ZSBpdFxuICAgICAgICAgICAgICAgICAgICAkZG9jdW1lbnQuZmluZCgnYm9keScpLmFwcGVuZChkb3dubG9hZExpbmspO1xuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaW5rWzBdLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZExpbmsucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG59KS5kaXJlY3RpdmUoJ2d0RXZlbnQnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGZuKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuJGxhc3Qpe1xuICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdndC1maW5pc2hlZC1yZW5kZXJpbmcnKTtcbiAgICAgICAgICAgICAgICAvL3Njb3BlLiRwYXJlbnQuJHBhcmVudC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufSkuZmlsdGVyKCdnZXRQcm9wZXJ0eScsZnVuY3Rpb24oJGZpbHRlcil7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNldHRpbmdzLCBrZXkscHJvcGVydHkpe1xuICAgICAgICAvL2NvbnNvbGUubG9nKGtleSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gJGZpbHRlcignZmlsdGVyJykoc2V0dGluZ3Mse29iamVjdEtleTprZXl9LHRydWUpWzBdW3Byb3BlcnR5XTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjYW5ub3QgcmVhZCBwcm9wZXJ0eTogXCInICsgcHJvcGVydHkgKyAnXCIgb24gbWlzc2luZyBrZXk6IFwiJyArIGtleSArICdcIiBpbiBzZXR0aW5ncy4nLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG59KS5maWx0ZXIoJ2d0UmVuZGVyJyxmdW5jdGlvbigkZmlsdGVyKXtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2V0dGluZ3MsIHJvdywga2V5KXtcbiAgICAgICAgLy9jb25zb2xlLmxvZygncmVuZGVyJyk7XG4gICAgICAgIHZhciBvdXRwdXQ7XG4gICAgICAgIC8vdmFyIG91dHB1dCA9IGFuZ3VsYXIuaXNBcnJheShzZXR0aW5ncykgPyAkZmlsdGVyKCdmaWx0ZXInKShzZXR0aW5ncyx7b2JqZWN0S2V5OmtleX0sdHJ1ZSlbMF1ba2V5XTogcm93W2tleV07XG4gICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoc2V0dGluZ3MpKSB7XG4gICAgICAgICAgICB2YXIgcmVuZGVyTWV0aG9kID0gJGZpbHRlcignZmlsdGVyJykoc2V0dGluZ3Mse29iamVjdEtleTprZXl9LHRydWUpWzBdLnJlbmRlcjtcbiAgICAgICAgICAgIGlmKHJlbmRlck1ldGhvZCAmJiBhbmd1bGFyLmlzRnVuY3Rpb24ocmVuZGVyTWV0aG9kKSl7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gcmVuZGVyTWV0aG9kKHJvdywga2V5KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gcm93W2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvdXRwdXQgPSByb3dba2V5XTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxufSkuZmlsdGVyKCdjYW1lbFRvRGFzaCcsZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gZnVuY3Rpb24oc3RyaW5nKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKCAvKFthLXpdKShbQS1aXSkvZywgJyQxLSQyJyApLnRvTG93ZXJDYXNlKCk7XG4gICAgfVxufSkuZmlsdGVyKCdndFNvcnQnLGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFycmF5LCBwcm9wZXJ0eUFycmF5KXtcbiAgICAgICAgZnVuY3Rpb24gZHluYW1pY1NvcnQocHJvcGVydHkpIHtcbiAgICAgICAgICAgIHZhciBzb3J0T3JkZXIgPSAxO1xuICAgICAgICAgICAgaWYocHJvcGVydHlbMF0gPT09IFwiLVwiKSB7XG4gICAgICAgICAgICAgICAgc29ydE9yZGVyID0gLTE7XG4gICAgICAgICAgICAgICAgcHJvcGVydHkgPSBwcm9wZXJ0eS5zdWJzdHIoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEsYikge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAoYVtwcm9wZXJ0eV0gPCBiW3Byb3BlcnR5XSkgPyAtMSA6IChhW3Byb3BlcnR5XSA+IGJbcHJvcGVydHldKSA/IDEgOiAwO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQgKiBzb3J0T3JkZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZHluYW1pY1NvcnRNdWx0aXBsZShwcm9wZXJ0eUFycmF5KSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogc2F2ZSB0aGUgYXJndW1lbnRzIG9iamVjdCBhcyBpdCB3aWxsIGJlIG92ZXJ3cml0dGVuXG4gICAgICAgICAgICAgKiBub3RlIHRoYXQgYXJndW1lbnRzIG9iamVjdCBpcyBhbiBhcnJheS1saWtlIG9iamVjdFxuICAgICAgICAgICAgICogY29uc2lzdGluZyBvZiB0aGUgbmFtZXMgb2YgdGhlIHByb3BlcnRpZXMgdG8gc29ydCBieVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgcHJvcHMgPSBwcm9wZXJ0eUFycmF5OyAvL2FyZ3VtZW50cztcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAob2JqMSwgb2JqMikge1xuICAgICAgICAgICAgICAgIHZhciBpID0gMCwgcmVzdWx0ID0gMCwgbnVtYmVyT2ZQcm9wZXJ0aWVzID0gcHJvcHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIC8qIHRyeSBnZXR0aW5nIGEgZGlmZmVyZW50IHJlc3VsdCBmcm9tIDAgKGVxdWFsKVxuICAgICAgICAgICAgICAgICAqIGFzIGxvbmcgYXMgd2UgaGF2ZSBleHRyYSBwcm9wZXJ0aWVzIHRvIGNvbXBhcmVcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB3aGlsZShyZXN1bHQgPT09IDAgJiYgaSA8IG51bWJlck9mUHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBkeW5hbWljU29ydChwcm9wc1tpXSkob2JqMSwgb2JqMik7XG4gICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXkuc29ydChkeW5hbWljU29ydE11bHRpcGxlKHByb3BlcnR5QXJyYXkpKTtcbiAgICB9XG59KTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
